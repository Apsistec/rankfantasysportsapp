<app-header [titleId]= "titleId"></app-header>
<ion-content class="text-wrap">
  <ion-grid>
    <ion-row>
      <ion-col size-sm="5" >
        <ng-container *ngIf="auth.user | async as user" >

        <ion-card color="primary"  class="ion-text-center" >
          <ion-card-header>
       <ion-card-title class="ion-text-center" >
         <ion-text color="secondary"  >
              User Profile
        </ion-text>
          </ion-card-title>
        </ion-card-header>
        <ion-item color="medium" lines="none">
          <ion-col size="4">
            <ion-img style="width:100px; height:100px; position:relative;" [src]="user.photoURL || '../../assets/img/dummy-user.png'"></ion-img>
          </ion-col>
          <ion-col class="ion-text-start">
            <ion-label>
              <ion-text color="warning" >
                {{ user.displayName || 'User' }}
              </ion-text>
              <hr>
              <ion-text color="twittr">
                {{ user.email }}
              </ion-text>
              <hr>
              {{ user.role }}
            </ion-label>    
          </ion-col>
          </ion-item>
        <ion-card-content>
        <ion-button strong size="small" shape="round" color="warning" routerLink="/settings">
            <ion-text>
            Edit User
          </ion-text>
        </ion-button>
      </ion-card-content>
    </ion-card>
    

    <ion-card color="primary" class="ion-text-center ion-padding" > 
      <ion-card-header>
        <ion-card-title>  
          
          <ion-text color="secondary">
            Subscription Details
          </ion-text>
        </ion-card-title>
      </ion-card-header>
      <ion-card-content class="ion-text-start">
        <ng-container *ngIf="subscriptions | async as subs; else purchase">
          <ion-grid>
            <ion-row class="ion-justify-content-around">
          <ion-col size-sm="5">
            <ion-label>
              <h2>
                Current Package:
              </h2>
   
                 <h3>
                  {{ subs.data[0].plan.id | uppercase }}
                 </h3>
            </ion-label>
  
        <ion-label>
        
        <h2 color="secondary">
          Status:
        </h2>
        <h3 color="warning">
          {{ subs.data[0].status | uppercase }}
            </h3>
          </ion-label>
        <ion-label>
        <h2 color="secondary" *ngIf="subs.data[0].status === 'trialing'">
          Trial Ends:
        </h2>
      <h3 color="warning" *ngIf="subs.data[0].status === 'trialing'">
      {{ subs.data[0].trial_end * 1000 | date }}
    </h3>
  </ion-label>
          
          <ion-label>
          <h2 color="secondary">
            Subscription Fee:
          </h2>
          <h3 color="warning">
            {{ subs.data[0].plan.amount / 100 | currency }}
          </h3>
        </ion-label>
        
        <ion-label>
        <h2 color="secondary">
          Billing Interval:
        </h2>
        <h3 color="warning">
          {{ subs.data[0].plan.interval | uppercase }}
        </h3>
      </ion-label>
      </ion-col>
      <ion-col size-sm="5">

    
        <ion-label>
        <h2 color="secondary">
          Date Created:
        </h2>
        <h3 color="warning">
          {{ subs.data[0].start_date * 1000 | date }}
        </h3>
      </ion-label>
        
       
        
          <ion-label>
          <h2 color="secondary">
            Current Cycle Start:
          </h2>
          <h3 color="warning">
            {{ subs.data[0].current_period_start * 1000 | date }}
          </h3>
        </ion-label>
      
          <ion-label>
          <h2 color="secondary">
            Current Cycle End:
          </h2>
          <h3 color="warning">
            {{ subs.data[0].current_period_end * 1000| date }}
          </h3>
        </ion-label>
      </ion-col>
            </ion-row>
          </ion-grid>

      </ng-container>
       
      </ion-card-content>
    </ion-card>
    
    <ng-template #purchase>
      <ion-card class="ion-text-center ion-padding" color="primary">
            <ion-button color="danger" shape="round" size="small" strong routerLink="/purchase">
        <ion-text >
          Buy Pro Package
        </ion-text>
      </ion-button>
        </ion-card>
    </ng-template>
    

<!-- Admin Dash -->
<ion-card class="ion-text-center" color="primary" *ngIf="user.role === 'ADMIN'">
  <ion-card-header>
  <ion-card-title>
    <ion-text color="secondary">
     Admin Dashboard
     </ion-text>
      </ion-card-title>
      <ion-card-subtitle>
        <ion-text color="warning">
         Reports & Admin Functions
        </ion-text>
      </ion-card-subtitle>
  </ion-card-header>
      <ion-card-content>
        <ion-button size="small" shape="round" color="warning" routerLink="/admin">
          <ion-icon slot="end" color="dark" name="glasses"></ion-icon>
          <ion-icon slot="start" color="dark" name="glasses"></ion-icon>
          <ion-text color="success">
            Admin Dashboard
          </ion-text>
        </ion-button>
      </ion-card-content>
    </ion-card>

    <!-- User Dashboard-->
    <ion-card class="ion-padding ion-text-center" color="primary" *ngIf="user.role === 'USER'">
      <ion-card-header>
      <ion-card-title>
        <ion-text color="secondary">
          User Support Dashboard
         </ion-text>
          </ion-card-title>
        <ion-card-subtitle>
          <ion-text color="warning">
            Request Support, Make a Feature Request, or a General Inquiry
          </ion-text>
          </ion-card-subtitle>
      </ion-card-header>
          <ion-card-content>
            <ion-text>
          <p>
            Not finding the answers you need? Open a support request, and we will get back to you ASAP!
          </p>
            </ion-text>
            <hr>
            <ion-button shape="round" color="warning" routerLink="/user">
              <ion-icon slot="start" color="dark" name="bug"></ion-icon>
              <ion-icon slot="end" color="dark" name="bug"></ion-icon>
              <ion-text color="success">
                Support Dashboard
              </ion-text>
            </ion-button>
          </ion-card-content>
        </ion-card>

        <!-- Account Management -->
              <ion-card class="ion-text-center" color="primary" *ngIf="(user.gold || user.silver || user.bronze)">
              <ion-card-header>
              <ion-card-title>
                <ion-text color="secondary">
                  Account Management
                </ion-text>
              </ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ng-container *ngIf="subscriptions | async as subs">

                <ion-button size="small" shape="round" color="secondary" [href]="'https://pay.stripe.com/invoice/' + subs.data[0].latest_invoice">
                  <ion-text color="dark">
                    Most Recent Invoice
                  </ion-text>
                </ion-button>
                <br>
                <ion-button size="small" shape="round" color="secondary" routerLink="/invoices">
                  <ion-text color="dark">
                    Past Invoices
                  </ion-text>
                </ion-button>
                <br>
                <ion-button size="small" shape="round" color="secondary" (click)="cancelSubscription()">
                  <ion-text color="dark">
                  Cancel Subscription  
                  </ion-text>
                </ion-button>
                <br>
              
                <ion-button  size="small" color="danger"  shape="round" (click)="auth.SignOut()" >Logout</ion-button>
                <!-- <ion-button  size="small" fill="outline" shape="round" (click)="cancelSubscription()" color="danger">Cancel Subscription</ion-button> -->
              </ng-container>
              </ion-card-content>
          </ion-card>
 


<!-- Theme -->
          <ion-card class="ion-text-center"  color="primary">
              <ion-card-header>
                <ion-card-title color="secondary">
                <strong>
                  <ion-text color="secondary">
                    Theme Options
                  </ion-text>
                </strong>
              </ion-card-title>
            </ion-card-header>
            <ion-card-content>
                  <ion-text color="warning">
                    <strong>
                      Current Theme Colors
                    </strong>
                  </ion-text>

                <hr>
            <ion-button  size="small"  expand="full" strong size="small" color="tertiary">Accent One</ion-button>
            <ion-button  size="small"  expand="full" strong size="small" color="light">Accent Two</ion-button>
            <ion-button  size="small"  expand="full" strong size="small" color="medium">Accent Three</ion-button>
            <ion-button  size="small"  expand="full" strong size="small" color="primary">Card Background</ion-button>
            <ion-button  size="small"  expand="full" strong size="small" color="secondary">Heading/Title</ion-button>
            <ion-button  size="small"  expand="full" strong size="small" color="warning">titles</ion-button>
            <hr>
                  <ion-card-subtitle>
              <ion-text color="warning">
                  Unique Themes
              </ion-text>
            </ion-card-subtitle>

            <ion-button  size="small"  color="success" (click)="changeTheme('autumn')">Option 1</ion-button>
            <ion-button  size="small"  color="success" (click)="changeTheme('night')">Option 2</ion-button>
            <ion-button  size="small"  color="success" (click)="changeTheme('neon')">Option 3</ion-button>
            <ion-button  size="small"  color="success" (click)="changeTheme('')">Default</ion-button>
            <ion-card-subtitle>
              <ion-text color="warning">
                  Pro Team Themes
              </ion-text>
            </ion-card-subtitle>
              <ion-button size="small" strong color="light">
                <ion-text color="danger">
                  Coming Soon!
                </ion-text>
              </ion-button>

            </ion-card-content>
          </ion-card>
        </ng-container>

        </ion-col>
        <ion-col>
          <app-list-tables></app-list-tables>
        </ion-col>
      </ion-row>
    </ion-grid>

</ion-content>
<app-footer></app-footer>
