<app-header [titleId]="titleId"></app-header>
<ion-content class="ion-text-wrap">
  <ion-grid>
    <ion-row>
      <ion-col class="ion-no-padding" size-sm="5">
        <ng-container *ngIf="auth.user | async as user">
          <ion-card color="light" class="ion-text-center">
            <ion-card-header>
              <ion-card-title class="ion-text-center">
                <ion-text>
                  User Profile
                </ion-text>
              </ion-card-title>
            </ion-card-header>
            <ion-item color="light" lines="none">
              <ion-grid>
                <ion-row>
                  <ion-col class="ion-no-padding" size="4">
                    <ion-img
                      style="width:70px; height:70px; position:relative;"
                      [src]="user.photoURL || '../../assets/img/dummy-user.png'"
                    ></ion-img>
                  </ion-col>
                  <ion-col class="ion-no-padding ion-text-start">
                    <ion-card-title>
                      <ion-text color="white">
                        <h2>
                          {{ user.displayName || 'User' }}
                        </h2>
                      </ion-text>
                    </ion-card-title>

                    <ion-card-subtitle>
                      {{ user.role }}
                    </ion-card-subtitle>
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-text color="white">
                    {{ user.email }}
                  </ion-text>
                </ion-row>
              </ion-grid>
            </ion-item>
            <ion-card-content>
              <ion-button
                strong
                size="small"
                (click)="presentSettingsModal()"
                color="silver"
              >
                <ion-text>
                  Edit User
                </ion-text>
              </ion-button>
              &nbsp;
              <ion-button size="small" (click)="auth.SignOut()"
                >Logout</ion-button
              >
            </ion-card-content>
          </ion-card>

          <ion-card color="light" class="ion-text-center ion-padding">
            <ion-card-header>
              <ion-card-title>
                <ion-text color="white">
                  Subscription Details
                </ion-text>
              </ion-card-title>
            </ion-card-header>
            <ion-card-content class="ion-text-start">
              <ng-container
                *ngIf="stripeService.subscriptions | async as subs; else purchase"
              >
                <ion-grid>
                  <ion-row class="">
                    <ion-col class="ion-no-padding" size-sm="5">
                      <ion-label>
                        <h2>
                          PRO Plan:
                        </h2>
                        <h3>
                          {{ subs.data[0].plan.id | uppercase }}
                        </h3>
                      </ion-label>

                      <ion-label>
                        <h2 color="white">
                          Status:
                        </h2>
                        <h3>
                          {{ subs.data[0].status | uppercase }}
                        </h3>
                      </ion-label>
                      <ion-label>
                        <h2
                          color="white"
                          *ngIf="subs.data[0].status === 'trialing'"
                        >
                          Trial Ends:
                        </h2>
                        <h3 *ngIf="subs.data[0].status === 'trialing'">
                          {{ subs.data[0].trial_end * 1000 | date }}
                        </h3>
                      </ion-label>
                      <ion-label>
                        <h2 color="white">
                          Subscription Fee:
                        </h2>
                        <h3>
                          {{ subs.data[0].plan.amount / 100 | currency }}
                        </h3>
                      </ion-label>
                    </ion-col>
                    <ion-col class="ion-no-padding" size-sm="5">
                      <ion-label>
                        <h2 color="white">
                          Created:
                        </h2>
                        <h3>
                          {{ subs.data[0].start_date * 1000 | date }}
                        </h3>
                      </ion-label>
                      <ion-label>
                        <h2 color="white">
                          Billing Start:
                        </h2>
                        <h3>
                          {{ subs.data[0].current_period_start * 1000 | date }}
                        </h3>
                      </ion-label>

                      <ion-label>
                        <h2 color="white">
                          Billing End:
                        </h2>
                        <h3>
                          {{ subs.data[0].current_period_end * 1000| date }}
                        </h3>
                      </ion-label>
                    </ion-col>
                  </ion-row>
                </ion-grid>
              </ng-container>
            </ion-card-content>
          </ion-card>

          <ng-template #purchase>
            <ion-button size="small" strong routerLink="/purchase">
              <ion-text>
                Buy Pro Package
              </ion-text>
            </ion-button>
          </ng-template>

          <!-- Admin Dash -->
          <ion-card
            class="ion-text-center"
            color="light"
            *ngIf="user.role === 'ADMIN'"
          >
            <ion-card-header>
              <ion-card-title>
                <ion-text color="white">
                  Admin Dashboard
                </ion-text>
              </ion-card-title>
              <ion-card-subtitle>
                <ion-text>
                  Reports & Admin Functions
                </ion-text>
              </ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <ion-button size="small" routerLink="/admin">
                <ion-icon slot="end" color="dark" name="glasses"></ion-icon>
                <ion-icon slot="start" color="dark" name="glasses"></ion-icon>
                <ion-text color="white">
                  Admin Dashboard
                </ion-text>
              </ion-button>
            </ion-card-content>
          </ion-card>

          <!-- User Dashboard-->
          <ion-card
            class="ion-padding ion-text-center"
            color="light"
            *ngIf="user.role === 'USER'"
          >
            <ion-card-header>
              <ion-card-title>
                <ion-text color="white">
                  User Support Dashboard
                </ion-text>
              </ion-card-title>
              <ion-card-subtitle>
                <ion-text>
                  Request Support, Make a Feature Request, or a General Inquiry
                </ion-text>
              </ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <ion-text>
                <p>
                  Not finding the answers you need? Open a support request, and
                  we will get back to you ASAP!
                </p>
              </ion-text>
              <hr />
              <ion-button routerLink="/user">
                <ion-icon slot="start" color="dark" name="bug"></ion-icon>
                <ion-icon slot="end" color="dark" name="bug"></ion-icon>
                <ion-text color="white">
                  Support Dashboard
                </ion-text>
              </ion-button>
            </ion-card-content>
          </ion-card>

          <!-- Account Management -->
          <ion-card
            class="ion-text-center"
            color="light"
            *ngIf="user.plan === 'gold' || 'silver' || 'bronze'"
          >
            <ion-card-header>
              <ion-card-title>
                <ion-text color="white">
                  Account Management
                </ion-text>
              </ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ng-container *ngIf="stripeService.subscriptions | async as subs">
                <ion-button
                  color="silver"
                  size="small"
                  [href]="'https://pay.stripe.com/invoice/' + subs.data[0].latest_invoice"
                >
                  <ion-text color="white">
                    Current Invoice
                  </ion-text>
                </ion-button>
                <ion-button
                  size="small"
                  color="white"
                  (click)="presentInvoicesModal()"
                >
                  <ion-text color="silver">
                    Invoice History
                  </ion-text>
                </ion-button>
                <br />
                <hr />
                <ion-button size="small" (click)="presentCancelSubModal()">
                  <ion-text color="danger">
                    Cancel Subscription
                  </ion-text>
                </ion-button>
              </ng-container>
            </ion-card-content>
          </ion-card>

          <!-- Theme -->
          <ion-card class="ion-text-center" color="light">
            <ion-card-header>
              <ion-card-title color="white">
                <strong>
                  <ion-text color="white">
                    Theme Options
                  </ion-text>
                </strong>
              </ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ion-text>
                <strong>
                  Current Theme Colors
                </strong>
              </ion-text>

              <hr />
              <ion-button size="small" expand="block" strong size="small"
                >Accent One</ion-button
              >
              <ion-button
                size="small"
                expand="block"
                strong
                size="small"
                color="light"
                >Accent Two</ion-button
              >
              <ion-button
                size="small"
                expand="block"
                strong
                size="small"
                color="light"
                >Accent Three</ion-button
              >
              <ion-button
                size="small"
                expand="block"
                strong
                size="small"
                color="light"
                >Card Background</ion-button
              >
              <ion-button
                size="small"
                expand="block"
                strong
                size="small"
                color="white"
                >Heading/Title</ion-button
              >

              <ion-card-subtitle>
                <ion-text>
                  Unique Themes
                </ion-text>
              </ion-card-subtitle>
            </ion-card-content>
          </ion-card>
        </ng-container>
      </ion-col>
      <ion-col class="ion-no-padding">
        <app-now></app-now>
        <app-tennis></app-tennis>
        <app-pga></app-pga>
        <app-nba></app-nba>
        <app-nfl></app-nfl>
        <app-cfb></app-cfb>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
<app-footer></app-footer>
