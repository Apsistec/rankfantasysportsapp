service cloud.firestore {
  match /databases/{database}/documents {
	 match /{document=**} {
      allow read, write: if false;
    }
  }
  match /posts/{document} {

    function getRoles() {
        return get(/databases/$(database)/documents/users/$(request.auth.uid)).data.roles;
    }

    allow read: if getRoles().hasAny(['admin', 'subscriber', 'visitor']) == true;
    allow update: if getRoles().hasAny(['admin', 'subscriber']) == true;
    allow write: if getRoles().hasAny(['admin']) == true;
  }
}
